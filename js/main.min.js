function layout(){var e=$(window),i=e.height(),t=e.width(),n=$("#main-content header"),c=$("#main-content aside"),s=$("#main-content article"),a=s.find(".thead"),h=(c.find("> section:last-child"),c.find("footer").height()),l=s.find("footer").height();s.width(t-c.outerWidth()),c.add(s).height(i-n.height()),c.find(".scroll").height(c.height()-h),s.find(".scroll").height(s.height()-a.height()-l),mailNote()}function initScroll(e,i){var t=e,n=$.extend({},{cursorcolor:"#CCE3F5",cursorwidth:"5px",cursorborderradius:"5px",autohidemode:!0,background:"",horizrailenabled:!1,cursorborder:"1px solid #fff",railoffset:!1},i);t.niceScroll(n),t.getNiceScroll().resize()}function leftRowHeight(){var e=$("#main-content > aside"),i=e.find(".list > li"),t=i.length,n=0;if(e.length>0)for(n;t>n;n++)i.eq(n).children("span").css("top",-(n+1)+"px")}function leftListChild(){var e=$("#main-content > aside"),i=e.find(".list > li"),t=e.children(".list-children");i.each(function(){var e=$(this),i=e.attr("class"),n=e.offset().top-40;t.find("."+i).css("top",n+"px")})}function tableCell(){var e=$(".tbody.scroll");if(e.length>0)for(var i=$(".thead th"),t=e.find("tr:first-child td"),n=0;n<i.length;n++)i.eq(n).width(t.eq(n).width())}function mailNote(){var e=$(".table span.note");e.children("span:first-child").css("width",""),e.each(function(){var e=$(this),i=e.children("span:first-child");i.outerWidth()>e.outerWidth()-e.children("span:last-child").width()-19&&i.css("width",e.outerWidth()-e.children("span:last-child").width()-20)})}function hover(e){var i=e,t=i.closest("div").find(".popover");i.children(".popover").length>0?i.hover(function(){t.toggleClass("in")}):i.add(t).hover(function(){t.toggleClass("in")})}var listHover=!1,childHover=!1,checkAllStatus="unchecked",checkListStatus="unchecked";$(function(){function e(e,i){var t=e.split(" "),t=t[i];return t}function i(){r.hasClass("hidden")&&(r.add(u).removeClass("hidden"),v.addClass("hidden"))}function t(i,t,n,a,h){t.is(":visible")&&t.addClass("hidden"),0==n.length?(r.append('<div class="group '+i+'"><span class="am-icon-close hidden"></span><div class="title">'+a+'</div><div class="term"></div></div>'),n=r.children("."+i).children(".term"),n.append(h)):"所有"==h?n.text(h):n.append(", "+h),r.children(".group").each(function(){var i=$(this),t=0==i.index()?1:0,n=e(i.attr("class"),1),a=l.find("> ."+n);i.hoverDelay({hoverEvent:function(){listHover=!0,i.hasClass("hover")||i.addClass("hover"),c(i,a,t,i)},outEvent:function(){s(a,i)}})})}function n(e,i,t,n,c){if(t.text().indexOf(",")>0){var s=t.text().split(", "+n).join("");s==t.text()?(s=t.text().split(n+",").join(""),t.text(s)):t.text(s)}else"所有"==t.text()?t.text(c):(r.children("."+e).remove(),i.removeClass("hidden"));""==r.html()&&(r.add(u).addClass("hidden"),v.removeClass("hidden"))}function c(e,i,t,n){function c(){setTimeout(function(){listHover||(i.removeClass("in").css("height","auto"),n.removeClass("hover"),l.length>0&&l.addClass("hidden"))},200)}var s=$(window).height(),a=e.offset().top,h=s-e.offset().top,l=e.children(".am-icon-close");i.hasClass("in")||i.addClass("in"),l.length>0&&l.removeClass("hidden"),i.outerHeight()>=h?(a>=.5*s-40?i.outerHeight()>=a?i.css({top:2-t+"px",height:a+"px"}):i.css({top:a-40-i.outerHeight()+42-t+"px",height:"auto"}):i.css({top:a-40-t+"px",height:h-40+"px"}),initScroll(i)):i.css("top",a-40-t+"px"),i.on("mouseover",function(){childHover=!0,listHover=!0}).on("mouseleave",function(){listHover=!1,childHover=!1,c()}),$(document).on("mouseover",".nicescroll-rails",function(){listHover=!0,childHover=!0}).on("mouseleave",".nicescroll-rails",function(){listHover=!1,childHover=!1,c()})}function s(e,i){var t=i.children(".am-icon-close");childHover||(e.removeClass("in").css("height","auto"),i.removeClass("hover"),t.length>0&&t.addClass("hidden"))}layout(),leftRowHeight(),leftListChild();var a=$(".scroll");if(a.length>0&&a.each(function(){var e=$(this),i="";(""==!e.data("scroll")||"undefined"==!e.data("scroll"))&&(i=e.data("scroll")),initScroll(e,i)}),$("header").on("click",".switch, .title",function(){var e=$(window),i=e.width(),t=$("#main-content aside"),n=$("#main-content article"),c=t.children(".scroll"),s=t.children("footer"),a=$("#main-content > header .contact"),h=$("#main-content > header .title"),l=t.data("isdh");if(l)return!1;if(t.data("isdh",!0),42==t.outerWidth())t.add(a).addClass("open"),t.animate({width:"216px"},"fast",function(){c.height(t.height()-s.height()).getNiceScroll().resize()}),n.animate({left:"216px",width:i-216+"px"},"fast",function(){t.data("isdh",!1)}),h.is(":hidden")&&h.removeClass("hidden");else{t.add(a).removeClass("open");$("aside footer").height();t.animate({width:"42px"},"fast",function(){c.height(t.height()-s.height()).getNiceScroll().resize()}),n.animate({left:"42px",width:i-42+"px"},"fast",function(){t.data("isdh",!1)}),a.is(":visible")&&h.addClass("hidden")}}),$("#main-content > aside .list").length>0){var h=$("#main-content > aside .list > li"),l=$("#main-content > aside > .list-children"),d=l.children(".popover.opt").children("li").not(".search"),o=l.children(".popover").find(".am-checkbox"),r=$("#main-content > aside .selected"),v=r.prev("h3"),u=r.next(".clear"),f=function(i,t){this.className=e(i,2),this.term=r.children("."+this.className).children(".term"),this.text=t,this.menu=$("#main-content > aside .list > li."+this.className),this.title=this.menu.text()},m=function(e){var i="";return e.children("li.active").each(function(){i+=$(this).text()+", "}),i=i.substring(0,i.lastIndexOf(", "))};h.each(function(){var e=$(this),i=e.index()+1,t=e.children("span"),n=e.attr("class"),a=l.find("> ."+n);e.hoverDelay({hoverEvent:function(){listHover=!0,t.hasClass("hover")||t.addClass("hover"),c(e,a,i,t)},outEvent:function(){s(a,t)}})}),o.on("click",'input[type="checkbox"]',function(e){var c=$(this),s=c.parents(".popover"),a=s.attr("class"),h=s.children("li.all").children(".am-checkbox").children(),l=c.parents("li").text(),d=new f(a,l);i(),c.is(":checked")?(c.parents("li").hasClass("all")?(c.parents("li").siblings("li").find(".am-checkbox").children().uCheck("check"),c.parents(".popover").children("li").addClass("active")):c.parents("li").addClass("active"),t(d.className,d.menu,d.term,d.title,d.text)):(c.parents("li").hasClass("all")?(c.parents("li").siblings("li").find(".am-checkbox").children().uCheck("uncheck"),c.parents(".popover").children("li").removeClass("active"),d.term.text("")):(c.parents("li").removeClass("active"),h.is(":checked")&&(h.uCheck("uncheck"),h.parents("li").removeClass("active"))),n(d.className,d.menu,d.term,d.text,m(s))),e.stopPropagation()}),d.on("click",function(){var e=$(this),c=e.parent(".popover").attr("class"),s=e.text(),a=new f(c,s);i(),e.hasClass("active")?(e.removeAttr("class"),n(a.className,a.menu,a.term,a.text,actives.newTerms)):(e.addClass("active"),t(a.className,a.menu,a.term,a.title,a.text))}),u.on("click",function(){r.empty(),popover.children("li.active").length>0&&popover.children("li.active").removeClass("active"),checkBox.is(":checked")&&checkBox.uCheck("uncheck"),h.hasClass("hidden")&&h.removeClass("hidden"),r.add(u).addClass("hidden"),v.removeClass("hidden")}),r.on("click",".group > .am-icon-close",function(){var i=e($(this).parent().attr("class"),1),t=l.children("."+i),n=t.find('.am-checkbox > input[type="checkbox"]'),c=r.siblings(".list").children("."+i);$(this).parent(".group").remove(),c.removeClass("hidden"),t.removeClass("in"),n.is(":checked")&&(n.uCheck("uncheck"),n.parents("li").removeClass("active")),""==r.html()&&(r.add(u).addClass("hidden"),v.removeClass("hidden"))}),l.find("#start-date").add(l.find("#end-date")).datetimepicker({format:"yyyy-mm-dd hh:ii",startView:"month"})}if($(".hover").length>0){var p=$(".hover");p.each(function(){var e=$(this);hover(e)})}if($("#main-content > article .check-all input[type='checkbox']").length>0){var k=$("#main-content > article .check-all input[type='checkbox']"),C=k.closest("div").find(".popover"),g=$(".tbody .am-checkbox"),x=g.children("input[type='checkbox']"),b=$(".tbody .circle"),w=C.children("li:first-child"),y=$("header .contact"),S=$("header .title");if(k.each(function(){var e=$(this);e.click(function(){if(e.is(":checked")){42==$("#main-content aside").outerWidth()&&S.addClass("hidden"),w.addClass("active"),e.val(w.html()),y.removeClass("hidden"),y.find(".checked").html(i),b.removeClass("in"),g.addClass("in"),x.uCheck("check"),k.uCheck("check"),checkAllStatus="checked";var i=g.children("input[type='checkbox']:checked").length;y.find(".checked").html(i)}else C.children("li").removeClass("active"),e.val(""),y.addClass("hidden"),S.is(":hidden")&&S.removeClass("hidden"),y.find(".checked").html("0"),b.addClass("in"),g.removeClass("in"),x.uCheck("uncheck"),k.uCheck("uncheck"),checkAllStatus="unchecked",checkListStatus="unchecked"})}),x.each(function(){var e=$(this);e.click(function(){var e=g.children("input[type='checkbox']:checked").length;e>0?(y.removeClass("hidden"),42==$("#main-content aside").outerWidth()&&S.addClass("hidden"),y.find(".checked").html(e),b.removeClass("in"),g.addClass("in"),checkListStatus="checked"):(k.is(":checked")&&(k.uCheck("uncheck"),checkAllStatus="unchecked"),y.addClass("hidden"),S.is(":hidden")&&S.removeClass("hidden"),y.find(".checked").html("0"),C.children("li").removeClass("active"),b.addClass("in"),g.removeClass("in"),checkListStatus="unchecked")})}),C.each(function(){var e,i=$(this),t=i.children("li");e=i.parents("footer").length>0?i.parents("footer").siblings("div").find(".popover"):i.parent("div").siblings("footer").find(".popover"),t.each(function(){var i=$(this),t=i.closest("div").find(".am-checkbox input[type='checkbox']");i.click(function(){var n=e.children("li").eq(i.index());if(2!==i.index()){if(i.addClass("active").siblings().removeClass("active"),n.addClass("active").siblings().removeClass("active"),t.uCheck("check").val(i.html()),y.removeClass("hidden"),42==$("#main-content aside").outerWidth()&&S.addClass("hidden"),b.removeClass("in"),g.addClass("in"),x.uCheck("check"),k.uCheck("check"),checkAllStatus="checked",0==i.index()){var c=g.children("input[type='checkbox']:checked").length;y.find(".checked").html(c)}}else i.siblings().removeClass("active"),n.siblings().removeClass("active"),t.uCheck("uncheck").val(""),y.addClass("hidden"),S.is(":hidden")&&S.removeClass("hidden"),y.find(".checked").html("0"),b.addClass("in"),g.removeClass("in"),x.uCheck("uncheck"),k.uCheck("uncheck"),checkAllStatus="unchecked",checkListStatus="unchecked"})})}),$(".tbody .circle").length>0){var H=$(".tbody .circle").parent("td");H.each(function(){var e=$(this),i=e.children(".circle"),t=e.children(".am-checkbox");e.hoverDelay({hoverEvent:function(){"unchecked"==checkAllStatus&&(i.removeClass("in"),t.addClass("in"))},outEvent:function(){"unchecked"==checkAllStatus&&"unchecked"==checkListStatus&&(i.addClass("in"),t.removeClass("in"))}})})}}}),$(window).resize(function(){layout()}),$.fn.hoverDelay=function(e){var i,t,n={hoverDuring:200,outDuring:200,hoverEvent:function(){$.noop()},outEvent:function(){$.noop()}},c=$.extend(n,e||{});return $(this).each(function(){$(this).hover(function(){clearTimeout(t),i=setTimeout(c.hoverEvent,c.hoverDuring)},function(){clearTimeout(i),t=setTimeout(c.outEvent,c.outDuring)})})};